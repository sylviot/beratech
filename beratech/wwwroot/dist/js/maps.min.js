(()=>{"use strict";var e,t={428:()=>{},512:()=>{var e={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle",DRAWING:"Drawing"},t={GEOMETRY_ADDED:"bera:geometryAdded",GEOMETRY_UPDATED:"bera:geometryUpdated",GEOMETRY_REMOVED:"bera:geometryRemoved",GEOMETRY_CLICKED:"bera:geometryClicked",GEOMETRY_HOVERED:"bera:geometryHovered",GEOMETRY_UNHOVERED:"bera:geometryUnhovered",MAP_CLEARED:"bera:cleared",MAP_READY:"bera:mapReady",THEME_CHANGED:"bera:themeChanged",STYLE_CHANGED:"bera:styleChanged",SELECTION_CHANGED:"bera:selectionChanged",ERROR:"bera:error"},r={center:[-8.7619,-63.9039],zoom:13,tileLayer:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileAttribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},n={POINT:{color:"#3388ff",radius:5,fillOpacity:.8},LINE_STRING:{color:"#ff7800",weight:3,opacity:.8},POLYGON:{color:"#3388ff",weight:2,opacity:.8,fillColor:"#3388ff",fillOpacity:.2},CIRCLE:{color:"#ff0000",weight:2,opacity:.8,fillColor:"#ff0000",fillOpacity:.2},DRAWING:{color:"#9c27b0",weight:2,opacity:.9,dashArray:"5, 5"}},o="2.0.0-modular";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var l=function(){return t=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.beraMap=t,this.geometries={},this.indexByType={},this.indexByUUID={},this.stats={totalCount:0,countByType:{}},this._boundsCache=null,this._boundsCacheDirty=!0,this._initialize()},r=[{key:"_initialize",value:function(){var t=this;Object.values(e).forEach(function(e){t.indexByType[e]=[],t.stats.countByType[e]=0}),console.log("‚úÖ GeoManager inicializado")}},{key:"addGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validateFeature(e))return console.error("‚ùå GeoManager: Feature inv√°lida"),null;var r=t.uuid||this._generateUUID();if(this.geometries[r])return this._updateExistingGeometry(r,e,t);var n=e.geometry.type,o={uuid:r,feature:this._deepClone(e),type:n,leafletLayer:null,style:t.style||{},metadata:t.metadata||{},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),properties:e.properties||{}};return this.geometries[r]=o,this.indexByUUID[r]=o,this._addToTypeIndex(n,r),this.stats.totalCount++,this.stats.countByType[n]++,this._boundsCacheDirty=!0,r}},{key:"addGeometriesBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(e))return[];var n=[];return e.forEach(function(e){var o=t.addGeometry(e,r);o&&n.push(o)}),n}},{key:"getGeometryByUUID",value:function(e){return this.geometries[e]||null}},{key:"getAllGeometries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.values(this.geometries);return e.type&&(t=t.filter(function(t){return t.type===e.type})),"createdAt"===e.sortBy&&t.sort(function(e,t){return new Date(e.createdAt)-new Date(t.createdAt)}),e.limit&&(t=t.slice(0,e.limit)),t}},{key:"getGeometriesByType",value:function(e){var t=this;return(this.indexByType[e]||[]).map(function(e){return t.geometries[e]}).filter(function(e){return e})}},{key:"getUUIDs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.indexByType[e]||[]:Object.keys(this.geometries)}},{key:"getGeometriesByProperty",value:function(e,t){return Object.values(this.geometries).filter(function(r){return r.properties&&r.properties[e]===t})}},{key:"searchByProperties",value:function(e){var t=new RegExp(e,"i");return Object.values(this.geometries).filter(function(e){return!!e.properties&&Object.values(e.properties).some(function(e){return t.test(String(e))})})}},{key:"updateGeometry",value:function(e,t){if(!this.geometries[e])return!1;if(!this._validateFeature(t))return!1;var r=this.geometries[e].type,n=t.geometry.type;return r!==n&&(this._removeFromTypeIndex(r,e),this._addToTypeIndex(n,e),this.stats.countByType[r]--,this.stats.countByType[n]++),this.geometries[e].feature=this._deepClone(t),this.geometries[e].type=n,this.geometries[e].properties=t.properties||{},this.geometries[e].updatedAt=(new Date).toISOString(),this._boundsCacheDirty=!0,!0}},{key:"removeGeometry",value:function(e){if(!this.geometries[e])return!1;var t=this.geometries[e],r=t.type;return t.leafletLayer&&t.leafletLayer.remove&&t.leafletLayer.remove(),this._removeFromTypeIndex(r,e),delete this.geometries[e],delete this.indexByUUID[e],this.stats.totalCount--,this.stats.countByType[r]--,this._boundsCacheDirty=!0,!0}},{key:"removeGeometriesBatch",value:function(e){var t=this;if(!Array.isArray(e))return 0;var r=0;return e.forEach(function(e){t.removeGeometry(e)&&r++}),r}},{key:"clear",value:function(){var e=this;return Object.values(this.geometries).forEach(function(e){e.leafletLayer&&e.leafletLayer.remove&&e.leafletLayer.remove()}),this.geometries={},this.indexByUUID={},Object.keys(this.indexByType).forEach(function(t){e.indexByType[t]=[]}),this.stats.totalCount=0,Object.keys(this.stats.countByType).forEach(function(t){e.stats.countByType[t]=0}),this._boundsCacheDirty=!0,Object.keys(this.geometries).length}},{key:"getCount",value:function(){return this.stats.totalCount}},{key:"getCountByType",value:function(){return Object.assign({},this.stats.countByType)}},{key:"getStats",value:function(){var e=this;return{totalCount:this.stats.totalCount,countByType:Object.assign({},this.stats.countByType),geometryTypes:Object.keys(this.indexByType).filter(function(t){return e.stats.countByType[t]>0})}}},{key:"hasGeometry",value:function(e){return!!this.geometries[e]}},{key:"exportAsGeoJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.values(this.geometries);e.type&&(t=t.filter(function(t){return t.type===e.type}));var r=t.map(function(t){return e.includeMetadata?Object.assign({},t.feature,{properties:Object.assign({},t.feature.properties||{},{_beraMapUUID:t.uuid,_beraMapType:t.type,_beraMapMetadata:t.metadata})}):t.feature});return{type:"FeatureCollection",features:r,metadata:{exportedAt:(new Date).toISOString(),count:r.length,generatedBy:"BeraMap GeoManager"}}}},{key:"calculateBounds",value:function(){if(!this._boundsCacheDirty&&this._boundsCache)return this._boundsCache;if(0===this.stats.totalCount)return null;var t=1/0,r=1/0,n=-1/0,o=-1/0;return Object.values(this.geometries).forEach(function(i){var a=i.feature.geometry.coordinates;i.type===e.POINT?(r=Math.min(r,a[0]),o=Math.max(o,a[0]),t=Math.min(t,a[1]),n=Math.max(n,a[1])):i.type===e.LINE_STRING||i.type===e.DRAWING?a.forEach(function(e){r=Math.min(r,e[0]),o=Math.max(o,e[0]),t=Math.min(t,e[1]),n=Math.max(n,e[1])}):i.type===e.POLYGON&&i.feature.geometry.coordinates[0].forEach(function(e){r=Math.min(r,e[0]),o=Math.max(o,e[0]),t=Math.min(t,e[1]),n=Math.max(n,e[1])})}),this._boundsCache={minLat:t,minLng:r,maxLat:n,maxLng:o},this._boundsCacheDirty=!1,this._boundsCache}},{key:"setLeafletLayer",value:function(e,t){return!!this.geometries[e]&&(this.geometries[e].leafletLayer=t,!0)}},{key:"_validateFeature",value:function(t){return!!(t&&"object"===i(t)&&"Feature"===t.type&&t.geometry&&t.geometry.type&&Object.values(e).includes(t.geometry.type)&&t.geometry.coordinates&&Array.isArray(t.geometry.coordinates))}},{key:"_generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{key:"_deepClone",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"_addToTypeIndex",value:function(e,t){this.indexByType[e]||(this.indexByType[e]=[]),this.indexByType[e].includes(t)||this.indexByType[e].push(t)}},{key:"_removeFromTypeIndex",value:function(e,t){if(this.indexByType[e]){var r=this.indexByType[e].indexOf(t);r>-1&&this.indexByType[e].splice(r,1)}}},{key:"_updateExistingGeometry",value:function(e,t,r){return this.updateGeometry(e,t,r),e}}],r&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){g(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(e,t,r){return(t=d(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}var v=function(){return e=function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!window.jQuery&&!window.$)throw new Error("EventManager: jQuery n√£o foi carregado");this.$=window.jQuery||window.$,this.beraMap=r,this.config={debug:n.debug||!1,namespace:n.namespace||"bera",useBubbling:!1!==n.useBubbling,useCapture:n.useCapture||!1},this.$eventTarget=n.$target||this.$(document),this.listeners={},this.EVENTS=t,this.eventHistory=[],this.maxHistorySize=n.maxHistorySize||100,this._initialize()},r=[{key:"_initialize",value:function(){console.log("‚úÖ EventManager inicializado"),console.log("   Namespace: "+this.config.namespace),console.log("   Debug: "+(this.config.debug?"ON":"OFF"))}},{key:"on",value:function(e,t,r){var n=this;if(!e||"function"!=typeof t)return console.error("‚ùå EventManager.on(): eventName e callback obrigat√≥rios"),null;var o=r?t.bind(r):t;return this._registerListener(e,o),this.$eventTarget.on(e,function(e,t){o(e,t)}),function(){return n.off(e,t)}}},{key:"once",value:function(e,t,r){if(!e||"function"!=typeof t)return console.error("‚ùå EventManager.once(): eventName e callback obrigat√≥rios"),null;var n=this,o=function(i,a){t.call(r,i,a),n.off(e,o)};return this.on(e,o,r)}},{key:"off",value:function(e,t){if(e){if(!t)return this.$eventTarget.off(e),void this._unregisterListener(e);this.$eventTarget.off(e,t),this._unregisterListener(e,t)}else console.warn("‚ö†Ô∏è EventManager.off(): eventName obrigat√≥rio")}},{key:"offAll",value:function(){var e=this;Object.values(this.EVENTS).forEach(function(t){e.$eventTarget.off(t)}),this.listeners={},console.log("‚úÖ EventManager: Todos os listeners removidos")}},{key:"trigger",value:function(e,t){if(!e)return console.error("‚ùå EventManager.trigger(): eventName obrigat√≥rio"),null;var r=Object.assign({},t||{},{timestamp:(new Date).toISOString(),eventName:e});return this.config.debug&&console.log("üì¢ EVENT DISPATCHED:",e,r),this._addToHistory(e,r),this.$eventTarget.trigger(e,[r])}},{key:"triggerSequence",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(n){var o=0,i=function(){if(o<e.length){var a=e[o],u=a.eventName,l=a.data;t.trigger(u,l),++o<e.length?setTimeout(i,r):n()}else n()};i()})}},{key:"triggerGeometryAdded",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trigger(this.EVENTS.GEOMETRY_ADDED,p({uuids:e,count:Array.isArray(e)?e.length:1},t))}},{key:"triggerGeometryUpdated",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trigger(this.EVENTS.GEOMETRY_UPDATED,p({uuids:e,count:Array.isArray(e)?e.length:1},t))}},{key:"triggerGeometryRemoved",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trigger(this.EVENTS.GEOMETRY_REMOVED,p({uuids:e,count:Array.isArray(e)?e.length:1},t))}},{key:"triggerGeometryClicked",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.trigger(this.EVENTS.GEOMETRY_CLICKED,{uuid:e,geometry:t,leafletEvent:r})}},{key:"triggerGeometryHovered",value:function(e,t){this.trigger(this.EVENTS.GEOMETRY_HOVERED,{uuid:e,geometry:t})}},{key:"triggerGeometryUnhovered",value:function(e,t){this.trigger(this.EVENTS.GEOMETRY_UNHOVERED,{uuid:e,geometry:t})}},{key:"triggerMapCleared",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.trigger(this.EVENTS.MAP_CLEARED,p({clearedAt:(new Date).toISOString()},e))}},{key:"triggerMapReady",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.trigger(this.EVENTS.MAP_READY,p({readyAt:(new Date).toISOString()},e))}},{key:"triggerError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.trigger(this.EVENTS.ERROR,{message:e,error:t,errorAt:(new Date).toISOString()})}},{key:"setDebug",value:function(e){this.config.debug=e,console.log("üîß EventManager debug: "+(e?"ON":"OFF"))}},{key:"getEventHistory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.eventHistory;return e.eventName&&(t=t.filter(function(t){return t.eventName===e.eventName})),e.limit&&(t=t.slice(-e.limit)),t}},{key:"clearEventHistory",value:function(){var e=this.eventHistory.length;return this.eventHistory=[],e}},{key:"getEventStats",value:function(){var e={totalEvents:this.eventHistory.length,byEventType:{},firstEventAt:null,lastEventAt:null};return this.eventHistory.forEach(function(t){e.byEventType[t.eventName]||(e.byEventType[t.eventName]=0),e.byEventType[t.eventName]++}),this.eventHistory.length>0&&(e.firstEventAt=this.eventHistory[0].timestamp,e.lastEventAt=this.eventHistory[this.eventHistory.length-1].timestamp),e}},{key:"getListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.listeners[e]||[]:Object.assign({},this.listeners)}},{key:"getListenerCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e)return(this.listeners[e]||[]).length;var t=0;return Object.values(this.listeners).forEach(function(e){t+=e.length}),t}},{key:"printReport",value:function(){console.group("üìä EventManager Report");var e=this.getEventStats();console.log("Total de eventos disparados:",e.totalEvents),e.firstEventAt&&(console.log("Primeiro evento:",e.firstEventAt),console.log("√öltimo evento:",e.lastEventAt)),console.log("Eventos por tipo:"),Object.entries(e.byEventType).forEach(function(e){var t=c(e,2),r=t[0],n=t[1];console.log("  - "+r+": "+n)}),console.log("Listeners registrados:",this.getListenerCount()),console.groupEnd()}},{key:"_registerListener",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({callback:t,registeredAt:(new Date).toISOString()}),this.config.debug&&console.log("‚úÖ Listener registrado para:",e)}},{key:"_unregisterListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.listeners[e]){if(!t)return delete this.listeners[e],void(this.config.debug&&console.log("‚úÖ Todos os listeners removidos para:",e));this.listeners[e]=this.listeners[e].filter(function(e){return e.callback!==t}),this.config.debug&&console.log("‚úÖ Listener removido para:",e)}}},{key:"_addToHistory",value:function(e,t){this.eventHistory.push({eventName:e,timestamp:(new Date).toISOString(),data:Object.assign({},t)}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}}],r&&h(e.prototype,r),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var _={"pt-BR":{popupLabels:{name:"Nome",description:"Descri√ß√£o",area:"√Årea",perimeter:"Per√≠metro",length:"Comprimento",circumference:"Circunfer√™ncia",radius:"Raio",isClosed:"Fechado",type:"Tipo",latLng:"Coordenadas",noInfo:"Sem informa√ß√µes dispon√≠veis"},geometryTypes:{Point:"Ponto",LineString:"Linha",Polygon:"Pol√≠gono",Circle:"C√≠rculo",Drawing:"Desenho",polygon:"Pol√≠gono",polyline:"Polilinha"},units:{meters:"m",kilometers:"km",squareMeters:"m¬≤",hectares:"ha",squareKilometers:"km¬≤"}},"en-US":{popupLabels:{name:"Name",description:"Description",area:"Area",perimeter:"Perimeter",length:"Length",circumference:"Circumference",radius:"Radius",isClosed:"Closed",type:"Type",latLng:"Coordinates",noInfo:"No information available"},geometryTypes:{Point:"Point",LineString:"Line",Polygon:"Polygon",Circle:"Circle",Drawing:"Drawing",polygon:"Polygon",polyline:"Polyline"},units:{meters:"m",kilometers:"km",squareMeters:"m¬≤",hectares:"ha",squareKilometers:"km¬≤"}}};function M(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=_[e]||_["pt-BR"],i=m(t.split("."));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!o||"object"!==b(o)||!(a in o))return n;o=o[a]}}catch(e){i.e(e)}finally{i.f()}return"string"==typeof o?o:n}function w(e){return e in _}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function L(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E(t)?t:t+""}var C=function(){return e=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.beraMap=t,this.geometryType=r,this.renderedLayers={},this.config=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach(function(t){L(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({debug:n.debug||!1,enablePopup:!1!==n.enablePopup,enableTooltip:!1!==n.enableTooltip,language:n.language||"pt-BR"},n),w(this.config.language)||(console.warn("Idioma '".concat(this.config.language,"' n√£o dispon√≠vel. Usando 'pt-BR'.")),this.config.language="pt-BR"),this.defaultStyle=n.defaultStyle||{}},t=[{key:"remove",value:function(e){if(!this.renderedLayers[e])return!1;var t=this.renderedLayers[e],r=this.beraMap._layerGroups[this.geometryType];return r&&t.remove&&r.removeLayer(t),delete this.renderedLayers[e],!0}},{key:"removeAll",value:function(){var e=this,t=Object.keys(this.renderedLayers),r=0;return t.forEach(function(t){e.remove(t)&&r++}),r}},{key:"getLayer",value:function(e){return this.renderedLayers[e]||null}},{key:"getAllLayers",value:function(){return Object.assign({},this.renderedLayers)}},{key:"getLayerCount",value:function(){return Object.keys(this.renderedLayers).length}},{key:"clear",value:function(){this.removeAll()}},{key:"setDefaultStyle",value:function(e){this.defaultStyle=Object.assign({},this.defaultStyle,e)}},{key:"getDefaultStyle",value:function(){return Object.assign({},this.defaultStyle)}},{key:"setLanguage",value:function(e){return w(e)?(this.config.language=e,!0):(console.warn("Idioma '".concat(e,"' n√£o dispon√≠vel.")),!1)}},{key:"getLanguage",value:function(){return this.config.language}},{key:"setDebug",value:function(e){this.config.debug=e}},{key:"_escapeHtml",value:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}},{key:"_validateUUID",value:function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}},{key:"_formatDistance",value:function(e){return e>=1e3?(e/1e3).toFixed(2)+" km":e.toFixed(2)+" m"}},{key:"_formatArea",value:function(e){var t=e/1e6;if(t>=1)return t.toFixed(4)+" km¬≤";var r=e/1e4;return r>=1?r.toFixed(4)+" ha":e.toFixed(2)+" m¬≤"}},{key:"_haversineDistance",value:function(e,t){var r=e[0]*Math.PI/180,n=t[0]*Math.PI/180,o=(t[0]-e[0])*Math.PI/180,i=(t[1]-e[1])*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(n)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371e3}},{key:"_log",value:function(e){this.config.debug&&console.log("[".concat(this.geometryType,"Renderer] ").concat(e))}},{key:"_logError",value:function(e){console.error("[".concat(this.geometryType,"Renderer] ‚ùå ").concat(e))}},{key:"_createPopupContent",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.properties||{},o=Object.keys(n).length>0,i='<div class="bera-popup">';n.name&&(i+='<h3 style="margin: 0 0 8px 0; font-weight: bold;">'.concat(this._escapeHtml(n.name),"</h3>")),n.description&&(i+='<p style="margin: 0 0 8px 0; font-size: 0.9em;">'.concat(this._escapeHtml(n.description),"</p>"));var a={area:"popupLabels.area",perimeter:"popupLabels.perimeter",length:"popupLabels.length",circumference:"popupLabels.circumference",radius:"popupLabels.radius",isClosed:"popupLabels.isClosed",type:"popupLabels.type"};if(r&&Object.keys(r).length>0&&(i+='<hr style="margin: 8px 0; border: none; border-top: 1px solid #ccc;">',Object.entries(r).forEach(function(e){var r=P(e,2),n=r[0],o=r[1];if(null!=o&&"uuid"!==n&&"feature"!==n&&"style"!==n&&"latLng"!==n){var u=o;"number"==typeof o&&(u=o.toFixed(2)),"type"!==n||"polygon"!==o&&"polyline"!==o||(u=M(t.config.language,"geometryTypes.".concat(o),o));var l=a[n];l=l?M(t.config.language,l,l):(l=n.replace(/([A-Z])/g," $1").trim()).charAt(0).toUpperCase()+l.slice(1),"isClosed"===n&&"boolean"==typeof o&&(u=o?"Sim":"N√£o","en-US"===t.config.language&&(u=o?"Yes":"No")),i+='<div style="margin: 4px 0; font-size: 0.85em;"><strong>'.concat(l,":</strong> ").concat(u,"</div>")}})),!(o||r&&0!==Object.keys(r).length)){var u=M(this.config.language,"popupLabels.noInfo","Sem informa√ß√µes dispon√≠veis");i+='<p style="margin: 0; font-size: 0.9em; color: #999; font-style: italic;">'.concat(u,"</p>")}return i+="</div>"}}],t&&k(e.prototype,t),r&&k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach(function(t){x(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function x(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}function R(e,t,r){return t=N(t),function(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,U()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}function U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(U=function(){return!!e})()}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}var H=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),R(this,t,[e,"Point",G(G({},r),{},{defaultStyle:{color:r.defaultColor||"#3388ff",radius:r.defaultRadius||5,fillOpacity:r.fillOpacity||.8}})])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),r=t,n=[{key:"render",value:function(e,t){if(!e||!t)return this._logError("uuid e feature obrigat√≥rios"),null;try{this.renderedLayers[e]&&this.remove(e);var r=t.geometry.coordinates,n=[r[1],r[0]],o=window.L.marker(n),i=this.beraMap._layerGroups[this.geometryType];return i&&o.addTo(i),this.renderedLayers[e]=o,this.beraMap._geoManager.setLeafletLayer(e,o),o._beraMetadata={uuid:e,feature:t,latLng:n},this._attachEventListeners(o,e,t),this._log("Point renderizado: ".concat(e)),o}catch(e){return this._logError("Erro ao renderizar: ".concat(e.message)),null}}},{key:"renderBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.forEach(function(e){var o=e.uuid,i=e.feature,a=t.render(o,i,r);a&&n.push(a)}),n}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.remove(e),this.render(e,t,r)}},{key:"getMetadata",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?Object.assign({},this.renderedLayers[e]._beraMetadata):null}},{key:"_attachEventListeners",value:function(e,t,r){var n=this;e.on("click",function(o){var i=n.beraMap._geoManager.getGeometryByUUID(t),a=e._beraMetadata||{};if(n.config.enablePopup){var u=n._createPopupContent(r,a);e.bindPopup(u).openPopup()}n.beraMap._eventManager.triggerGeometryClicked(t,i,o),n._log("Point clicado: ".concat(t))}),e.on("mouseover",function(r){var o=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryHovered(t,o),e.setOpacity(.7)}),e.on("mouseout",function(r){var o=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryUnhovered(t,o),e.setOpacity(1)})}}],n&&B(r.prototype,n),o&&B(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(C);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach(function(t){$(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function $(e,t,r){return(t=q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function q(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:t+""}function W(e,t,r){return t=Q(t),function(e,t){if(t&&("object"==F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,K()?Reflect.construct(t,r||[],Q(e).constructor):t.apply(e,r))}function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(K=function(){return!!e})()}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}var X=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),W(this,t,[e,"LineString",Y(Y({},r),{},{defaultStyle:{color:r.defaultColor||"#ff7800",weight:r.defaultWeight||3,opacity:r.defaultOpacity||.8,lineCap:r.lineCap||"round",lineJoin:r.lineJoin||"round"}})])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(t,e),r=t,n=[{key:"render",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return this._logError("uuid e feature obrigat√≥rios"),null;try{this.renderedLayers[e]&&this.remove(e);var n=t.geometry.coordinates.map(function(e){return[e[1],e[0]]}),o=Object.assign({},this.defaultStyle,r),i=window.L.polyline(n,{color:o.color,weight:o.weight,opacity:o.opacity,lineCap:o.lineCap,lineJoin:o.lineJoin}),a=this.beraMap._layerGroups[this.geometryType];return a&&i.addTo(a),this.renderedLayers[e]=i,this.beraMap._geoManager.setLeafletLayer(e,i),i._beraMetadata={uuid:e,feature:t,style:o,length:this._calculateLength(n)},this._attachEventListeners(i,e,t),this._log("LineString renderizado: ".concat(e)),i}catch(e){return this._logError("Erro ao renderizar: ".concat(e.message)),null}}},{key:"renderBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.forEach(function(e){var o=e.uuid,i=e.feature,a=t.render(o,i,r);a&&n.push(a)}),n}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.remove(e),this.render(e,t,r)}},{key:"getLength",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.length:null}},{key:"getMetadata",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?Object.assign({},this.renderedLayers[e]._beraMetadata):null}},{key:"_attachEventListeners",value:function(e,t,r){var n=this;e.on("click",function(o){var i=n.beraMap._geoManager.getGeometryByUUID(t),a=e._beraMetadata||{};if(n.config.enablePopup){var u=n._createPopupContent(r,a);e.bindPopup(u).openPopup(o.latlng)}n.beraMap._eventManager.triggerGeometryClicked(t,i,o),n._log("LineString clicado: ".concat(t))}),e.on("mouseover",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryHovered(t,r),e.setStyle({weight:n.defaultStyle.weight+2,opacity:1})}),e.on("mouseout",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryUnhovered(t,r),e.setStyle({weight:n.defaultStyle.weight,opacity:n.defaultStyle.opacity})})}},{key:"_calculateLength",value:function(e){for(var t=0,r=0;r<e.length-1;r++)t+=this._haversineDistance(e[r],e[r+1]);return t}}],n&&J(r.prototype,n),o&&J(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(C);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach(function(t){ie(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ie(e,t,r){return(t=ue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ue(n.key),n)}}function ue(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}function le(e,t,r){return t=ce(t),function(e,t){if(t&&("object"==ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,se()?Reflect.construct(t,r||[],ce(e).constructor):t.apply(e,r))}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(se=function(){return!!e})()}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}var ye=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),le(this,t,[e,"Polygon",oe(oe({},r),{},{defaultStyle:{color:r.defaultColor||"#3388ff",weight:r.defaultWeight||2,opacity:r.defaultOpacity||.8,fillColor:r.defaultFillColor||"#3388ff",fillOpacity:r.defaultFillOpacity||.2}})])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(t,e),r=t,n=[{key:"render",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return this._logError("uuid e feature obrigat√≥rios"),null;try{this.renderedLayers[e]&&this.remove(e);var n=t.geometry.coordinates[0].map(function(e){return[e[1],e[0]]}),o=Object.assign({},this.defaultStyle,r),i=window.L.polygon(n,{color:o.color,weight:o.weight,opacity:o.opacity,fillColor:o.fillColor,fillOpacity:o.fillOpacity}),a=this.beraMap._layerGroups[this.geometryType];return a&&i.addTo(a),this.renderedLayers[e]=i,this.beraMap._geoManager.setLeafletLayer(e,i),i._beraMetadata={uuid:e,feature:t,style:o,area:this._calculateArea(n),perimeter:this._calculatePerimeter(n)},this._attachEventListeners(i,e,t),this._log("Polygon renderizado: ".concat(e)),i}catch(e){return this._logError("Erro ao renderizar: ".concat(e.message)),null}}},{key:"renderBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.forEach(function(e){var o=e.uuid,i=e.feature,a=t.render(o,i,r);a&&n.push(a)}),n}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.remove(e),this.render(e,t,r)}},{key:"getArea",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.area:null}},{key:"getPerimeter",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.perimeter:null}},{key:"getMetadata",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?Object.assign({},this.renderedLayers[e]._beraMetadata):null}},{key:"isPointInPolygon",value:function(e,t,r){if(!this.renderedLayers[e])return!1;if(!this.renderedLayers[e].getBounds().contains([t,r]))return!1;var n=this.renderedLayers[e]._beraMetadata.feature.geometry.coordinates[0];return this._pointInPolygon([r,t],n)}},{key:"_attachEventListeners",value:function(e,t,r){var n=this;e.on("click",function(o){var i=n.beraMap._geoManager.getGeometryByUUID(t),a=e._beraMetadata||{};if(n.config.enablePopup){var u=n._createPopupContent(r,a);e.bindPopup(u).openPopup(o.latlng)}n.beraMap._eventManager.triggerGeometryClicked(t,i,o),n._log("Polygon clicado: ".concat(t))}),e.on("mouseover",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryHovered(t,r),e.setStyle({weight:n.defaultStyle.weight+2,opacity:1,fillOpacity:n.defaultStyle.fillOpacity+.2})}),e.on("mouseout",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryUnhovered(t,r),e.setStyle({weight:n.defaultStyle.weight,opacity:n.defaultStyle.opacity,fillOpacity:n.defaultStyle.fillOpacity})})}},{key:"_calculateArea",value:function(e){for(var t=0,r=6371e3,n=0;n<e.length-1;n++){var o=e[n],i=e[n+1],a=o[0]*Math.PI/180,u=i[0]*Math.PI/180,l=(i[1]-o[1])*Math.PI/180;t+=Math.sin(a)*Math.cos(u)*Math.sin(l),t-=Math.sin(u)*Math.cos(a)*Math.sin(l)}return t=Math.abs(t*r*r)/2}},{key:"_calculatePerimeter",value:function(e){for(var t=0,r=0;r<e.length;r++){var n=(r+1)%e.length;t+=this._haversineDistance(e[r],e[n])}return t}},{key:"_pointInPolygon",value:function(e,t){for(var r=te(e,2),n=r[0],o=r[1],i=!1,a=0,u=t.length-1;a<t.length;u=a++){var l=te(t[a],2),s=l[0],c=l[1],f=te(t[u],2),y=f[0],p=f[1];c>o!=p>o&&n<(y-s)*(o-c)/(p-c)+s&&(i=!i)}return i}}],n&&ae(r.prototype,n),o&&ae(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(C);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach(function(t){de(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function de(e,t,r){return(t=be(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,be(n.key),n)}}function be(e){var t=function(e,t){if("object"!=pe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pe(t)?t:t+""}function me(e,t,r){return t=_e(t),function(e,t){if(t&&("object"==pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Oe()?Reflect.construct(t,r||[],_e(e).constructor):t.apply(e,r))}function Oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Oe=function(){return!!e})()}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}function Me(e,t){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Me(e,t)}var we=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=me(this,t,[e,"Circle",he(he({},n),{},{defaultStyle:{color:n.defaultColor||"#ff0000",weight:n.defaultWeight||2,opacity:n.defaultOpacity||.8,fillColor:n.defaultFillColor||"#ff0000",fillOpacity:n.defaultFillOpacity||.2}})])).config.defaultRadius=n.defaultRadius||500,r.config.enablePulse=!1!==n.enablePulse,r.config.pulseOpacityMin=n.pulseOpacityMin||.3,r.config.pulseOpacityMax=n.pulseOpacityMax||.8,r.config.pulseDuration=n.pulseDuration||1500,r.pulsingCircles=new Set,r.pulseAnimations=new Map,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Me(e,t)}(t,e),r=t,n=[{key:"render",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return this._logError("uuid e feature obrigat√≥rios"),null;try{var o,i;this.renderedLayers[e]&&this.remove(e);var a=t.geometry.coordinates,u=[a[1],a[0]],l=this.config.defaultRadius;if(null!==(o=t.geometry.properties)&&void 0!==o&&o.radius?l=t.geometry.properties.radius:null!==(i=t.properties)&&void 0!==i&&i.radius&&(l=t.properties.radius),l<=0)return this._logError("raio deve ser maior que 0"),null;var s=Object.assign({},this.defaultStyle,n),c=window.L.circle(u,{radius:l,color:s.color,weight:s.weight,opacity:s.opacity,fillColor:s.fillColor,fillOpacity:s.fillOpacity}),f=this.beraMap._layerGroups[this.geometryType];return f&&c.addTo(f),this.renderedLayers[e]=c,this.beraMap._geoManager.setLeafletLayer(e,c),c._beraMetadata={uuid:e,feature:t,style:s,latLng:u,radius:l,area:this._calculateArea(l),circumference:this._calculateCircumference(l),isPulsing:!1},this._attachEventListeners(c,e,t),this.config.enablePulse&&setTimeout(function(){r.startPulse(e)},100),this._log("Circle renderizado: ".concat(e)),c}catch(e){return this._logError("Erro ao renderizar: ".concat(e.message)),null}}},{key:"renderBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.forEach(function(e){var o=e.uuid,i=e.feature,a=t.render(o,i,r);a&&n.push(a)}),n}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.remove(e),this.render(e,t,r)}},{key:"startPulse",value:function(e){var t=this;if(!this.renderedLayers[e])return this._logError("C√≠rculo n√£o encontrado: ".concat(e)),!1;if(this.pulsingCircles.has(e))return!0;var r=this.renderedLayers[e],n=r._beraMetadata,o=this.config.pulseOpacityMin,i=this.config.pulseOpacityMax,a=this.config.pulseDuration,u=null,l=null,s=function(n){u||(u=n);var c,f=(n-u)%a/a;c=f<.5?o+2*f*(i-o):i-2*(f-.5)*(i-o);try{r.setStyle({fillOpacity:c})}catch(e){t._logError("Erro ao aplicar estilo: ".concat(e.message))}t.pulsingCircles.has(e)&&(l=requestAnimationFrame(s))};return this.pulsingCircles.add(e),n&&(n.isPulsing=!0),l=requestAnimationFrame(s),this.pulseAnimations.set(e,l),this._log("Pulsa√ß√£o iniciada: ".concat(e)),!0}},{key:"stopPulse",value:function(e){if(!this.renderedLayers[e])return!1;var t=this.renderedLayers[e],r=t._beraMetadata,n=this.pulseAnimations.get(e);if(n&&(cancelAnimationFrame(n),this.pulseAnimations.delete(e)),this.pulsingCircles.delete(e),r){r.isPulsing=!1;try{t.setStyle({fillOpacity:r.style.fillOpacity})}catch(e){}}return this._log("Pulsa√ß√£o parada: ".concat(e)),!0}},{key:"togglePulse",value:function(e){if(!this.renderedLayers[e])return!1;var t=this.renderedLayers[e]._beraMetadata;return t&&t.isPulsing?(this.stopPulse(e),!1):(this.startPulse(e),!0)}},{key:"stopAllPulses",value:function(){var e=this,t=0;return Array.from(this.pulsingCircles).forEach(function(r){e.stopPulse(r)&&t++}),t}},{key:"startAllPulses",value:function(){var e=this,t=0;return Object.keys(this.renderedLayers).forEach(function(r){e.startPulse(r)&&t++}),t}},{key:"getArea",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.area:null}},{key:"getCircumference",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.circumference:null}},{key:"getMetadata",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?Object.assign({},this.renderedLayers[e]._beraMetadata):null}},{key:"isPointInCircle",value:function(e,t,r){if(!this.renderedLayers[e])return!1;var n=this.renderedLayers[e]._beraMetadata,o=n.latLng[0],i=n.latLng[1],a=n.radius;return this._haversineDistance([t,r],[o,i])<=a}},{key:"_attachEventListeners",value:function(e,t,r){var n=this;e.on("click",function(o){var i=n.beraMap._geoManager.getGeometryByUUID(t),a=e._beraMetadata||{};if(n.config.enablePopup){var u=n._createPopupContent(r,a);e.bindPopup(u).openPopup(o.latlng)}n.beraMap._eventManager.triggerGeometryClicked(t,i,o),n._log("Circle clicado: ".concat(t))}),e.on("mouseover",function(r){var o=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryHovered(t,o),e.setStyle({weight:n.defaultStyle.weight+2,opacity:1,fillOpacity:n.defaultStyle.fillOpacity+.2})}),e.on("mouseout",function(r){var o=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryUnhovered(t,o),e.setStyle({weight:n.defaultStyle.weight,opacity:n.defaultStyle.opacity,fillOpacity:n.defaultStyle.fillOpacity})})}},{key:"_calculateArea",value:function(e){return Math.PI*e*e}},{key:"_calculateCircumference",value:function(e){return 2*Math.PI*e}}],n&&ve(r.prototype,n),o&&ve(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(C);function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach(function(t){Se(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Se(e,t,r){return(t=ke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ke(n.key),n)}}function ke(e){var t=function(e,t){if("object"!=Ee(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ee(t)?t:t+""}function Te(e,t,r){return t=De(t),function(e,t){if(t&&("object"==Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ce()?Reflect.construct(t,r||[],De(e).constructor):t.apply(e,r))}function Ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ce=function(){return!!e})()}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ae(e,t)}var Ge=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Te(this,t,[e,"Drawing",je(je({},n),{},{defaultStyle:{color:n.defaultColor||"#9c27b0",weight:n.defaultWeight||2,opacity:n.defaultOpacity||.9,dashArray:n.defaultDashArray||"5, 5",lineCap:n.lineCap||"round",lineJoin:n.lineJoin||"round"}})])).config.closedLineThreshold=n.closedLineThreshold||1e-5,r.config.autoDetectClosed=!1!==n.autoDetectClosed,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}(t,e),r=t,n=[{key:"render",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return this._logError("uuid e feature obrigat√≥rios"),null;try{this.renderedLayers[e]&&this.remove(e);var n,o=t.geometry.coordinates.map(function(e){return[e[1],e[0]]}),i=this._isClosedLine(o),a=Object.assign({},this.defaultStyle,r),u=window.L;n=i&&this.config.autoDetectClosed?u.polygon(o,{color:a.color,weight:a.weight,opacity:a.opacity,fillColor:a.color,fillOpacity:.2,dashArray:a.dashArray,lineCap:a.lineCap,lineJoin:a.lineJoin}):u.polyline(o,{color:a.color,weight:a.weight,opacity:a.opacity,dashArray:a.dashArray,lineCap:a.lineCap,lineJoin:a.lineJoin});var l=this.beraMap._layerGroups[this.geometryType];return l&&n.addTo(l),this.renderedLayers[e]=n,this.beraMap._geoManager.setLeafletLayer(e,n),n._beraMetadata={uuid:e,feature:t,style:a,isClosed:i,length:this._calculateLength(o),area:i?this._calculateArea(o):null,type:i?"polygon":"polyline"},this._attachEventListeners(n,e,t),this._log("Drawing renderizado: ".concat(e," (").concat(i?"fechado":"aberto",")")),n}catch(e){return this._logError("Erro ao renderizar: ".concat(e.message)),null}}},{key:"renderBatch",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.forEach(function(e){var o=e.uuid,i=e.feature,a=t.render(o,i,r);a&&n.push(a)}),n}},{key:"update",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.remove(e),this.render(e,t,r)}},{key:"getLength",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.length:null}},{key:"getArea",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.area:null}},{key:"isClosed",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?this.renderedLayers[e]._beraMetadata.isClosed:null}},{key:"getMetadata",value:function(e){return this.renderedLayers[e]&&this.renderedLayers[e]._beraMetadata?Object.assign({},this.renderedLayers[e]._beraMetadata):null}},{key:"_attachEventListeners",value:function(e,t,r){var n=this;e.on("click",function(o){var i=n.beraMap._geoManager.getGeometryByUUID(t),a=e._beraMetadata||{};if(n.config.enablePopup){var u=n._createPopupContent(r,a);e.bindPopup(u).openPopup(o.latlng)}n.beraMap._eventManager.triggerGeometryClicked(t,i,o),n._log("Drawing clicado: ".concat(t))}),e.on("mouseover",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryHovered(t,r),e.setStyle({weight:n.defaultStyle.weight+2,opacity:1})}),e.on("mouseout",function(){var r=n.beraMap._geoManager.getGeometryByUUID(t);n.beraMap._eventManager.triggerGeometryUnhovered(t,r),e.setStyle({weight:n.defaultStyle.weight,opacity:n.defaultStyle.opacity})})}},{key:"_isClosedLine",value:function(e){if(e.length<3)return!1;var t=e[0],r=e[e.length-1],n=Math.abs(t[0]-r[0]),o=Math.abs(t[1]-r[1]);return n<this.config.closedLineThreshold&&o<this.config.closedLineThreshold}},{key:"_calculateLength",value:function(e){for(var t=0,r=0;r<e.length-1;r++)t+=this._haversineDistance(e[r],e[r+1]);return t}},{key:"_calculateArea",value:function(e){for(var t=0,r=6371e3,n=0;n<e.length-1;n++){var o=e[n],i=e[n+1],a=o[0]*Math.PI/180,u=i[0]*Math.PI/180,l=(i[1]-o[1])*Math.PI/180;t+=Math.sin(a)*Math.cos(u)*Math.sin(l),t-=Math.sin(u)*Math.cos(a)*Math.sin(l)}return t=Math.abs(t*r*r)/2}}],n&&Le(r.prototype,n),o&&Le(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(C);function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ie(n.key),n)}}function Ie(e){var t=function(e,t){if("object"!=xe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xe(t)?t:t+""}var Re=function(){return t=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!window.L)throw new Error("BeraMap: Leaflet n√£o foi carregado");this.L=window.L,this._containerId=t,this._config=this._mergeConfig(r,n),this._map=null,this._layerGroups={},this._geoManager=null,this._eventManager=null,this._renderers={},this._initialized=!1,this._initialize()},n=[{key:"_initialize",value:function(){try{this._map=this.L.map(this._containerId).setView(this._config.center,this._config.zoom),this.L.tileLayer(this._config.tileLayer,{attribution:this._config.tileAttribution}).addTo(this._map),this._initializeLayerGroups(),this._initializeManagers(),this._initialized=!0,console.log("‚úÖ BeraMap v"+o+" inicializado com sucesso")}catch(e){throw console.error("‚ùå Erro ao inicializar BeraMap:",e),e}}},{key:"_initializeLayerGroups",value:function(){var t=this;Object.values(e).forEach(function(e){t._layerGroups[e]=t.L.layerGroup().addTo(t._map)})}},{key:"_initializeManagers",value:function(){this._eventManager=new v(this),this._geoManager=new l(this),this._renderers={Point:new H(this),LineString:new X(this),Polygon:new ye(this),Circle:new we(this),Drawing:new Ge(this)}}},{key:"addGeometries",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._initialized)return console.error("BeraMap: plugin n√£o inicializado"),[];try{var n=this._normalizeFeatures(e);if(!n||0===n.length)return console.warn("BeraMap: nenhuma feature para adicionar"),[];var o=[];return n.forEach(function(e){var n=t._geoManager.addGeometry(e,r),i=e.geometry.type;t._renderers[i]&&t._renderers[i].render(n,e),o.push(n)}),this._eventManager.trigger("bera:geometryAdded",{uuids:o,count:o.length}),r.fitBounds&&this.fitBounds(o),o}catch(e){return console.error("‚ùå Erro ao adicionar geometrias:",e),[]}}},{key:"updateGeometries",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._initialized)return console.error("BeraMap: plugin n√£o inicializado"),[];try{var r=this._normalizeFeatures(e);if(!r||0===r.length)return console.warn("BeraMap: nenhuma feature para atualizar"),[];t.clearPrevious&&this.clearAll();var n=this.addGeometries(e,t);return this._eventManager.trigger("bera:geometryUpdated",{uuids:n,count:n.length}),n}catch(e){return console.error("‚ùå Erro ao atualizar geometrias:",e),[]}}},{key:"removeGeometries",value:function(e){var t=this;if(!this._initialized)return console.error("BeraMap: plugin n√£o inicializado"),!1;var r=Array.isArray(e)?e:[e];try{var n=[];return r.forEach(function(e){var r=t._geoManager.getGeometryByUUID(e);if(r){var o=r.feature.geometry.type;t._renderers[o]&&t._renderers[o].remove(e),t._geoManager.removeGeometry(e),n.push(e)}}),n.length>0&&this._eventManager.trigger("bera:geometryRemoved",{uuids:n,count:n.length}),n.length===r.length}catch(e){return console.error("‚ùå Erro ao remover geometrias:",e),!1}}},{key:"clearAll",value:function(){if(this._initialized)try{Object.values(this._layerGroups).forEach(function(e){e.clearLayers()}),this._geoManager.clear(),this._eventManager.trigger("bera:cleared",{}),console.log("‚úÖ Todas as geometrias foram removidas")}catch(e){console.error("‚ùå Erro ao limpar mapa:",e)}else console.error("BeraMap: plugin n√£o inicializado")}},{key:"fitBounds",value:function(e){var t=this;if(e&&0!==e.length||(e=this._geoManager.getUUIDs()),0!==e.length){var r=this.L.latLngBounds([]);e.forEach(function(e){var n=t._geoManager.getGeometryByUUID(e);n&&n.leafletLayer&&("function"==typeof n.leafletLayer.getBounds?r.extend(n.leafletLayer.getBounds()):"function"==typeof n.leafletLayer.getLatLng&&r.extend(n.leafletLayer.getLatLng()))}),r.isValid()&&this._map.fitBounds(r,{padding:[50,50]})}else console.warn("BeraMap: nenhuma geometria para encaixar")}},{key:"on",value:function(e,t,r){this._eventManager.on(e,t,r)}},{key:"off",value:function(e,t){this._eventManager.off(e,t)}},{key:"getGeometryByUUID",value:function(e){return this._geoManager.getGeometryByUUID(e)}},{key:"getAllGeometries",value:function(){return this._geoManager.getAllGeometries()}},{key:"getGeometriesByType",value:function(e){return this._geoManager.getGeometriesByType(e)}},{key:"getGeometriesCount",value:function(){return this._geoManager.getCount()}},{key:"getStats",value:function(){return this._geoManager.getStats()}},{key:"exportGeoJSON",value:function(){return this._geoManager.exportAsGeoJSON()}},{key:"getLeafletMap",value:function(){return this._map}},{key:"getRenderer",value:function(e){return this._renderers[e]||null}},{key:"getRenderers",value:function(){return Object.assign({},this._renderers)}},{key:"getGeoManager",value:function(){return this._geoManager}},{key:"getEventManager",value:function(){return this._eventManager}},{key:"isInitialized",value:function(){return this._initialized}},{key:"getVersion",value:function(){return o}},{key:"_normalizeFeatures",value:function(e){return e?"FeatureCollection"===e.type&&Array.isArray(e.features)?e.features:"Feature"===e.type?[e]:[]:[]}},{key:"_mergeConfig",value:function(e,t){return Object.assign({},e,t||{})}}],n&&Be(t.prototype,n),i&&Be(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,i}();function Ue(e){return new Re(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}"undefined"!=typeof window&&(window.BeraMap={init:Ue,version:o,BeraMap:Re,GeoManager:l,EventManager:v,Renderers:{BaseRenderer:C,PointRenderer:H,LineRenderer:X,PolygonRenderer:ye,CircleRenderer:we,DrawingRenderer:Ge},Constants:{GEOMETRY_TYPES:e,EVENTS:t,DEFAULT_CONFIG:r,STYLE_PRESETS:n}})}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=(t,r,o,i)=>{if(!r){var a=1/0;for(c=0;c<e.length;c++){for(var[r,o,i]=e[c],u=!0,l=0;l<r.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every(e=>n.O[e](r[l]))?r.splice(l--,1):(u=!1,i<a&&(a=i));if(u){e.splice(c--,1);var s=o();void 0!==s&&(t=s)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,o,i]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={536:0,473:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,i,[a,u,l]=r,s=0;if(a.some(t=>0!==e[t])){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(l)var c=l(n)}for(t&&t(r);s<a.length;s++)i=a[s],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.O(void 0,[473],()=>n(512));var o=n.O(void 0,[473],()=>n(428));o=n.O(o)})();